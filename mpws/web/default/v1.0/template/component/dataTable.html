{* Component: DataTable  

    !!!PLEASE COPY THIS MESSAGE TO NEW COMPONENT FILE!!!

    Component Required Arguments:
    _confing: datatable configuration
    _data: simple data retreived from DB


    !!!DO NOT MODIFY STANDART SECTION!!!

    Standart Required Arguments:
    _resource: 'widget', 'component', etc. Property text will be given from the file according to this value
    _ownerType: Each property key must start with this name.
    _ownerName: influences on property keys


    proeprty file: %locale%/%_resource%.proeprty@%_ownerType%+'someText'+%_ownerName%

    Ex.:

    file: en_us/widget.property
           .      .
          /|\    /|\
           |      |
           |      |_ value of $_resource
           |_ current locale


    entry:  
        dataTableView ActiveUsers Caption Name
           .              .         .      .
          /|\            /|\       /|\    /|\
           |              |         |      |
           |              |         |      |_ column key (depends on data)
           |              |         |_ specifyc property key
           |              |_ it's $_ownerName value
           |_ value of $_ownerType


   To Populate Standart Arguments Use This Line:
   _ownerType=$_ownerType _ownerName=$_ownerName _resource=$_resource

    standart custom property key
    {assign var="__prop__" value="objectProperty_custom_`$_ownerName`"}

*}

{$_controlOwner = 'DataTable'}

<div id="MPWSComponentDataTable{$_ownerName|capitalize}ID" class="MPWSComponent MPWSComponentDataTable MPWSComponentDataTable{$_ownerName|capitalize}">
    {include file=$CURRENT.OBJECT->objectTemplatePath_simple_header _key=$_controlOwner}

{* data table content *}
{if count($_data) eq 0}

    <div class="MPWSBlock MPWSRenderModeError">
        <span class="MPWSText">{$CURRENT.OBJECT->objectProperty_widget_dataTableViewDataEmpty}</span>
    </div>

{elseif count($_data) gt 0}

    <div class="MPWSBlock MPWSBlockTopActions">
    {* render table top captions *}
    {if isset($_confing.datatable.tableTopActions)}
        {foreach $_confing.datatable.tableTopActions as $_actionName}
            {include file=$CURRENT.OBJECT->objectTemplatePath_trigger_control
                _type='mpwsLinkAction'
                _name=$_actionName
                _controlOwner="`$_controlOwner`TopAction"
                _action=$_actionName
                _resourceOwner=$_resourceOwner
                _single=true
                _mode='system'}
        {/foreach}
    {/if}
    </div>


    <div class="MPWSDataTableRows">
    {* render table captions *}
    {if isset($_confing.datatable.displayCaptions) and $_confing.datatable.displayCaptions}
        <div class="MPWSDataTableRow MPWSDataTableRowCaptions">


        {if not empty($_confing.datatable.actions)}
            <div class="MPWSDataTableCell MPWSDataTableCellCaption MPWSDataTableCellActions">
                {$CURRENT.OBJECT->objectProperty_widget_dataTableViewCaptionActions}
            </div>
        {/if}

        {if isset($_confing.datatable.fields)}
            {foreach $_confing.datatable.fields as $fieldKey}
                <div class="MPWSDataTableCell MPWSDataTableCellCaption MPWSDataTableCell{$fieldKey|capitalize}">
                    {$CURRENT.OBJECT->{"objectProperty_`$_resourceOwner`_caption`$fieldKey`"}}
                </div>
            {/foreach}
        {else}
            {foreach $_data.0 as $cellEntry}
                <div class="MPWSDataTableCell MPWSDataTableCellCaption MPWSDataTableCell{$cellEntry@key|capitalize}">
                    {$CURRENT.OBJECT->{"objectProperty_`$_resourceOwner`_caption`$cellEntry@key`"}}
                </div>
            {/foreach}
        {/if}
        </div>
    {/if}

    {foreach $_data as $rowIndex => $rowEntry}
        <div class="MPWSDataTableRow MPWSDataTableRow{$rowIndex}">

        {if not empty($_confing.datatable.perRecrodActions)}
            <div class="MPWSDataTableCell MPWSDataTableCellActions">
            {foreach $_confing.datatable.perRecrodActions as $_actionName}
                <span class="MPWSDataTableCellAction MPWSDataTableCellAction{$actionName|capitalize:0:1}">
                {include file=$CURRENT.OBJECT->objectTemplatePath_trigger_control
                    _type='mpwsLinkAction'
                    _name=$_actionName
                    _controlOwner="`$_controlOwner`RowAction"
                    _action=$_actionName
                    _resourceOwner=$_resourceOwner
                    _single=true
                    _mode='system'}
                </span>
            {/foreach}
            </div>
        {/if}

        {if isset($_confing.datatable.fields)}
            {* display all data according to fields *}
            {foreach $_confing.datatable.fields as $fieldKey}
                <div class="MPWSDataTableCell MPWSDataTableCell{$fieldKey|capitalize}">{$rowEntry[$fieldKey]}</div>
            {/foreach}
        {else}
            {* display all data *}
            {foreach $rowEntry as $fieldKey => $cellEntry}
                <div class="MPWSDataTableCell MPWSDataTableCell{$fieldKey|capitalize}">{$cellEntry}</div>
            {/foreach}
        {/if}
        </div>
    {/foreach}
    
    </div>

{else}
    {include file=$CURRENT.OBJECT->objectTemplatePath_component_exception _message="Data object does not have content to render" _tpl=$smarty.template}
{/if}
</div>