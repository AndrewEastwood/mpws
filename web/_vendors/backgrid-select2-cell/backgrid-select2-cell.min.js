/*
  backgrid-select2-cell
  http://github.com/wyuenho/backgrid

  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
!function(a,b){"object"==typeof exports?(require("select2"),module.exports=b(a,require("underscore"),require("backgrid"))):b(a,a._,a.Backgrid)}(this,function(a,b,c){"use strict";var d=c.Extension.Select2CellEditor=c.SelectCellEditor.extend({events:{change:"save"},select2Options:{openOnEnter:!1},initialize:function(){c.SelectCellEditor.prototype.initialize.apply(this,arguments),this.close=b.bind(this.close,this)},setSelect2Options:function(a){this.select2Options=b.extend(a||{})},render:function(){return c.SelectCellEditor.prototype.render.apply(this,arguments),this.$el.select2(this.select2Options),this},postRender:function(){var b=this;b.multiple?b.$el.select2("container").keydown(b.close):b.$el.data("select2").focusser.keydown(b.close),b.$el.on("select2-blur",function(c){if(b.multiple)var d=a.setTimeout(function(){a.clearTimeout(d),b.$el.select2("isFocused")||(c.type="blur",b.close(c))},200);else c.type="blur",b.close(c)}).select2("focus")},remove:function(){return this.$el.select2("destroy"),c.SelectCellEditor.prototype.remove.apply(this,arguments)}});c.Extension.Select2Cell=c.SelectCell.extend({className:"select2-cell",editor:d,select2Options:null,initialize:function(a){c.SelectCell.prototype.initialize.apply(this,arguments),this.select2Options=a.select2Options||this.select2Options,this.listenTo(this.model,"backgrid:edit",function(a,b,c,d){b.get("name")==this.column.get("name")&&d.setSelect2Options(this.select2Options)})}})});